# 未实现核心模块详细清单

| 模块名称           | 目录路径                | 当前状态             | 核心缺失功能描述                                                                                                                                    |
| :----------------- | :---------------------- | :------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------- |
| **小说生成服务**   | `cmd/story-gen-svc`     | 占位 (Unimplemented) | 1. 章节大纲与内容生成的 Eino 工作流实现。<br>2. 与 LLM 的实际交互逻辑（Prompt 模板、流式输出处理）。<br>3. 章节续写与重新生成的业务闭环。           |
| **RAG 检索服务**   | `cmd/rag-retrieval-svc` | 占位 (Unimplemented) | 1. 基于 Milvus 的向量搜索逻辑封装。<br>2. 知识库（设定集、角色信息）的 Embedding 注入与匹配算法。<br>3. 检索结果的重排序（Rerank）逻辑。            |
| **记忆服务**       | `cmd/memory-svc`        | 占位 (Unimplemented) | 1. 长短期记忆（Long/Short-term Memory）的存储与提取逻辑。<br>2. 实体状态演变（Entity State）的自动化追踪与快照记录。<br>3. 角色关系动态变化的维护。 |
| **校验服务**       | `cmd/validator-svc`     | 占位 (Unimplemented) | 1. 生成内容的一致性校验（逻辑矛盾检测）。<br>2. 内容安全合规性审查（对接外部或内置审核引擎）。<br>3. 小说设定冲突的自动化检测。                     |
| **异步任务执行器** | `cmd/job-worker`        | 结构存在/业务缺失    | 1. 核心生成任务的任务分发机制（Task Dispatcher）。<br>2. 任务执行状态机（State Machine）的完整链路。<br>3. 异常任务重试、熔断与通知逻辑。           |
| **文件服务**       | `cmd/file-svc`          | 空目录 (Empty)       | 1. 用户上传素材、导出小说 PDF/Epub 的存储接口。<br>2. 对接 R2 或本地文件系统的 Provider 实现。<br>3. 静态资源的 URL 签名与访问控制。                |
| **管理服务**       | `cmd/admin-svc`         | 空目录 (Empty)       | 1. 超级管理后台接口（全租户监控、配置下发）。<br>2. 系统级日志审计与数据清理任务。<br>3. 动态 RBAC 权限配置的管理入口。                             |

## 详细分析：

### 1. 小说生成服务 - `story-gen-svc`

- **现状**：gRPC 定义存在，但 `story_service.go` 中所有方法直接返回 `codes.Unimplemented`。
- **缺失**：它是整个项目的“大脑”，目前缺乏 Eino 编排好的生成链条（Chains）和节点（Nodes）。

### 2. RAG 检索服务 - `rag-retrieval-svc`

- **现状**：`internal/infrastructure/persistence/milvus` 有基础配置，但检索逻辑未打通。
- **缺失**：无法实际从向量数据库中召回相关剧情背景或设定，导致生成可能出现“OOC”（脱离设定）。

### 3. 记忆服务 - `memory-svc`

- **现状**：设计文档中提到了“记忆链”，但代码中 `memory_service.go` 还是模板。
- **缺失**：没有实现如何将生成的章节内容沉淀为“实体状态历史”，这会导致创作长篇时前后文失去关联。

### 4. 异步任务执行器 - `job-worker`

- **现状**：有 Redis Stream 基础结构，但没有对应的 Consumer 逻辑。
- **缺失**：当用户调用 `POST /generate` 后，系统虽然能接受任务，但没人去真正执行耗时较长的生成操作。

### 5. 纯预留模块（管理与文件）

- **管理服务**：缺失了对多租户全局视角的管控能力。
- **文件服务**：作为后端，目前还没有处理二进制文件（如封面、导出文档）的任何能力。
